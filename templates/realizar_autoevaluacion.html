<!DOCTYPE html> 
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>Autoevaluación - {{ trabajador.get_full_name|default:trabajador.username }}</title>
    <style>
        /* Fuentes y reset básico */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #e6f2e6;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #2f4f2f;
        }

        .container {
            background: #e6f2e6; /* Cambiado de blanco a verde claro para mantener el color */
            border-radius: 14px;
            box-shadow: 0 8px 25px rgba(46, 117, 46, 0.3);
            max-width: 650px;
            width: 100%;
            padding: 35px 40px;
            text-align: center;
            transition: box-shadow 0.3s ease;
        }

        .container:hover {
            box-shadow: 0 12px 40px rgba(46, 117, 46, 0.45);
        }

        h1 {
            margin-bottom: 30px;
            font-weight: 700;
            font-size: 2.4rem;
            color: #2a452a;
            text-shadow: 1px 1px 2px rgba(107, 142, 107, 0.5);
        }

        /* Barra de progreso */
        .progress-container {
            position: relative;
            background: #d3e4d3;
            border-radius: 25px;
            height: 28px;
            margin-bottom: 30px;
            box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.1);
            user-select: none;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #4caf50 0%, #81c784 100%);
            border-radius: 25px;
            box-shadow: 0 0 10px #4caf50aa;
            transition: width 0.4s ease;
        }

        .progress-left-text,
        .progress-right-text {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-weight: 600;
            font-size: 1rem;
            color: #2f4f2f;
            user-select: none;
        }

        .progress-left-text {
            left: 15px;
        }

        .progress-right-text {
            right: 15px;
        }

        /* Indicadores */
        .indicador-block {
            border: 1px solid #a8d5a8;
            padding: 18px 25px;
            margin-bottom: 22px;
            border-radius: 12px;
            background: #f4fbf4;
            box-shadow: 0 4px 12px rgba(72, 160, 72, 0.15);
            text-align: left;
        }

        .indicador-block label {
            font-weight: 700;
            font-size: 1.15rem;
            color: #2a452a;
            margin-bottom: 10px;
            display: block;
        }

        .radio-group {
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .radio-group input[type="radio"] {
            display: none;
        }

        .radio-group label {
            flex: 1;
            cursor: pointer;
            border-radius: 10px;
            padding: 14px 0;
            font-weight: 700;
            font-size: 1rem;
            text-align: center;
            user-select: none;
            border: 2.5px solid transparent;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        /* Colores para estados */
        .radio-group label.malo {
            background-color: #fcdede;
            color: #a44a4a;
            border-color: #f7a8a8;
        }

        .radio-group label.regular {
            background-color: #fff8db;
            color: #a68b2a;
            border-color: #ffea88;
        }

        .radio-group label.bueno {
            background-color: #d7f5d7;
            color: #2e7d32;
            border-color: #a5d6a7;
        }

        /* Estado seleccionado */
        .radio-group input[type="radio"]:checked + label {
            box-shadow: 0 0 16px 3px #4caf50;
            border-color: #4caf50;
            transform: scale(1.1);
            font-weight: 800;
            color: inherit; /* <- Aquí está el cambio */
            transition: all 0.3s ease;
        }

        /* Hover - más sobresalido */
        .radio-group label:hover {
            opacity: 1;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
            transform: scale(1.12);
            color: #fff !important;
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease, color 0.3s ease;
        }

        .radio-group label.malo:hover {
            background-color: #d9534f; /* rojo intenso */
            border-color: #d43f3a;
        }

        .radio-group label.regular:hover {
            background-color: #f0ad4e; /* naranja intenso */
            border-color: #ec971f;
        }

        .radio-group label.bueno:hover {
            background-color: #5cb85c; /* verde intenso */
            border-color: #4cae4c;
        }

        /* Botones */
        .button-group {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }

        button[type="submit"],
        .back-button {
            flex: 1;
            padding: 16px 0;
            border-radius: 14px;
            font-size: 1.15rem;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 6px 15px rgba(76, 175, 80, 0.4);
            user-select: none;
            border: none;
            color: white;
        }

        button[type="submit"] {
            background: linear-gradient(135deg, #4caf50, #388e3c);
        }

        button[type="submit"]:hover {
            background: linear-gradient(135deg, #388e3c, #2e7d32);
            box-shadow: 0 8px 18px rgba(56, 142, 60, 0.7);
            transform: scale(1.05);
        }

        .back-button {
            background: linear-gradient(135deg, #999999, #666666);
            box-shadow: 0 6px 15px rgba(100, 100, 100, 0.4);
            text-decoration: none;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .back-button:hover {
            background: linear-gradient(135deg, #666666, #444444);
            box-shadow: 0 8px 18px rgba(68, 68, 68, 0.7);
            transform: scale(1.05);
        }

        .no-indicadores {
            color: #b71c1c;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 25px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Autoevaluación - {{ trabajador.get_full_name|default:trabajador.username }}</h1>

        <!-- Contenedor progreso con textos -->
        <div class="progress-container" aria-label="Progreso de la autoevaluación">
            <span class="progress-left-text" id="progress-text"></span>
            <div class="progress-bar" id="progress-bar"></div>
            <span class="progress-right-text" id="progress-percent"></span>
        </div>

        <form method="post" id="autoform">
            {% csrf_token %}

            <h3>Indicadores:</h3>
            {% if indicadores %}
            {% for indicador in indicadores %}
            <div class="indicador-block">
                <label>{{ indicador.nombre }}</label>
                <div class="radio-group">
                    <input type="radio" id="malo_{{ indicador.id }}" name="indicador_{{ indicador.id }}" value="Malo"
                        required />
                    <label for="malo_{{ indicador.id }}" class="malo">Malo</label>

                    <input type="radio" id="regular_{{ indicador.id }}" name="indicador_{{ indicador.id }}"
                        value="Regular" required />
                    <label for="regular_{{ indicador.id }}" class="regular">Regular</label>

                    <input type="radio" id="bueno_{{ indicador.id }}" name="indicador_{{ indicador.id }}" value="Bueno"
                        required />
                    <label for="bueno_{{ indicador.id }}" class="bueno">Bueno</label>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="no-indicadores">No hay indicadores disponibles.</div>
            {% endif %}

            <div class="button-group">
                <button type="submit">Enviar</button>
                <a href="{% url 'admin_dashboard' %}" class="back-button">Volver</a>
            </div>
        </form>
    </div>

    <script>
        (() => {
            const form = document.getElementById('autoform');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const progressPercent = document.getElementById('progress-percent');
            const radioGroups = form.querySelectorAll('.radio-group');

            const totalIndicators = radioGroups.length;

            function updateProgress() {
                let answeredCount = 0;
                radioGroups.forEach(group => {
                    const checked = group.querySelector('input[type="radio"]:checked');
                    if (checked) {
                        answeredCount++;
                    }
                });

                const percent = Math.round((answeredCount / totalIndicators) * 100);

                progressBar.style.width = percent + '%';

                progressText.textContent = `${answeredCount} de ${totalIndicators}`;
                progressPercent.textContent = `${percent}%`;
            }

            radioGroups.forEach(group => {
                const radios = group.querySelectorAll('input[type="radio"]');
                radios.forEach(radio => {
                    radio.addEventListener('change', updateProgress);
                });
            });

            updateProgress();
        })();
    </script>
</body>

</html>
